 ---
title: "Hurricane Lee Report"
author: "Jinyu Li, Yuyang Li, Handing Zhang, Zening Ye"
date: "11/17/2021"
output: pdf_document
header-includes: \usepackage{setspace}\doublespacing
---

```{r setup,include = FALSE}
pacman::p_load(tidyverse,ggplot2,lubridate,magrittr,rlang,gstat,fields,hurricaneexposure,hurricaneexposuredata,knitr,gridExtra,
               drat,dplyr,gstat
               )
source("bouy_plot.R")
source("download_data.R")
source("variogram_wind_precip.R")
source("Visualization_Danny.R")
```

# Introduction
The hurricane we chose was hurricane Lee, a.k.a, Tropical Storm Lee. It was the thirteenth named storm and fifteenth system overall of the 2011 Atlantic hurricane season. The formed date of the hurricane was September 2, and it dissipated on September 7, 2021. According to Wikipedia, hurricane Lee caused $2.8 billion in damage to the landfall area, and it was also the first subtropical or tropical storm to make landfall in Louisiana since Hurricane Gustav in 2008. In addition, the name Lee was used again in the 2017 season, even though it caused damage and loss of life. This report will analyze the main effects that Hurricane Lee caused for the states and counties, such as floods and tornadoes. In addition, this report contains three main parts: Movement Tract, Exploratory Data Analysis and Conclusion. 

# Hurricane Movement
The hurricane data records every 6 hours for its movement. Hurricane Lee affected the following states: Louisiana, Mississippi, Alabama, Texas, New York, Pennsylvania, and Washington D.C Area. In addition, Lee caused historic flooding in Pennsylvania, New York. 
```{r fig.align='center', echo = F, out.width = '85%'}
map_tracks(storms = "Lee-2011",
           alpha = 0.5, plot_points = TRUE, color = "blue")
```

# Explorary Data Analysis
## Data Cleaning
The data we used from the National Oceanic and Atmospheric Administration(NOAA) and “hurricaneexposure” and “hurricaneexposuredata” packages from Brooke Anderson. For buoy data, we downloaded the data from NOAA and did some simple cleaning. For instance, we combined the time data from the NOAA since it is not a formal time format (Table 1). Furthermore, we calculated the mean and median of the data by using every 6 hours and we deleted some useless data from the original dataset (Table 2).  

For hurricane data, we first filtered the Lee’s data from the original dataset in several aspects, such as precipitation rate, model wind speed in each county and estimate wind speed in each county. Finally, we used inner join to combine datasets into one, this dataset was used for making variograms in the future. 

<<<<<<< HEAD
According to the data, we define 2011/09/04 18:00:00 as the landfall time of the hurricane and the buoy station, AMRL1, we chose is near the location of the landfall. Our analysis and visualization will focus but not limited on the period of time from 09/04 12:00 to 09/05 06:00 which we divided into three 6-hour periods and respectively represent the period before, during and after the landfall of Hurricane Lee.
```{r echo = F, message=FALSE}
=======
According to the data, we define 2011/09/04 18:00:00 as the landfall time of the hurricane and the buoy station, AMRL1, we chose is near the location of the landfall. Our analysis and visualization will focus but not limited on the period of time from 09/04 12:00 to 09/05 06:00 which we divided into 3 6-hour periods and respectively represent the period before, during and after the landfall of Hurricane Lee.
```{r echo = F, message=FALSE, fig.align='center'}
>>>>>>> fe7381a3f59fd1eb283078d18dab75773e5141f6
table1 <- buoyCbind() %>% rename(Year = "#YY") %>% rename(`Date/Time` = "DT" )
kable(head(table1[c(1:4,241:244),]), caption = "Buoy Data in Every 6 Minutes")
table2 <- calculate_stat_per6h() %>% 
  rename(m6h_WDIR = "WDIR_mid_6h") %>% 
  rename(m6h_WSPD = "WSPD_mid_6h") %>%
  rename(m6h_GST = "GST_mid_6h") %>% 
  rename(m6h_PRES = "PRES_mid_6h") %>%
  rename(m6h_ATMP = "ATMP_mid_6h") %>%
  rename(m6h_WTMP = "WTMP_mid_6h")
kable(table2[1:10,], caption = "Average Buoy Data in Every 6 Hours")
table3 <- data_join()
```

## Precipitation in Difference Counties
Since the main impact of the whole hurricane was the danger to personal property and life safety caused by its flooding, there is some correlation between the amount of precipitation and flooding. Therefore, our group started with the analysis of rainfall between different regions. The first two plots indicated different precipitation and flood events happened in different areas. The third plot which means the timeline for the wind speed (m/s) through the area. 
```{r echo = F, warning=FALSE, fig.align='center', out.height = '50%', out.width= '90%'}
map_counties(storm = "Lee-2011", metric = "rainfall")
floyd_map <- map_event_exposure(storm = "Lee-2011", event_type = "flood")
map_tracks(storms = "Lee-2011", plot_object = floyd_map, plot_points = TRUE, 
           color = "darkgray")
buoyData(WSPD, "WSPD")
```

Based on the plots, we noticed the data we have for hurricane tracts cannot fully match with the data of rain. By comparing the first two plots, even though the hurricane tracks were recorded and stopped at the edge of Tennessee, the impact of the Lee still extended until New York. According to the Tropical Cyclone Report, “The rain from Lee’s remnants exacerbated the flood situation in the Mid-Atlantic and caused some of the most severe flooding in this region’s history.” Furthermore,  in some of these areas water levels broke previous record heights that were set in the Mid-Atlantic Floods of 2006.


##  How the buoy data reflected the landfall of Hurricane Lee. 

We picked buoy amr1, 29°26'58" N 91°20'17" W, which is relatively the closest to the landfall of the hurricane. The plots below demonstrate the density of  average wind per hour and average peak Gust Speed (reported every 6 minutes) per hour from September 2nd 00:00 till September 6th 18:00. 

```{r echo=FALSE, message=FALSE, warning=FALSE, out.height = '80%', out.width= '55%', fig.align='center'}
plot1()
plot2()
```

Observing the plot we can see that there are some fairly large increases on both measure of wind speed from Sept. 3rd to Sept. 5th, which is likely to be related to the landfall of the hurricane. We also took a look at the average Sea Level Atmosphere recorded at our buoy during Lee. We can clearly see that there’s  a huge drop from Sept. 3rd to Sept. 5th

```{r echo=FALSE, message=FALSE, warning=FALSE, out.width='75%', out.height= '75%', fig.align='center'}
plot3()
```

As mentioned in “Average sea level pressure is 1013.25 millibars or 29.92 inches of mercury. A drop in atmospheric pressure usually indicates the approach of a storm, such as a hurricane.”(Hurricane Glossary, by SECOORA) As we can see from the density plot, the average sea level atmospheric pressure dropped far below the average level of 1013.25 millibars under normal circumstances. Therefore it is highly likely that the Approaching and landfall of Lee caused the drop of atmospheric pressure.

Below are the time series plots for the three measurements at our buoy mentioned above. The average wind speed and average peak gust speed plots shows us where the three major spikes took place during the landfall of Lee, where the sea level atmospheric pressure time series plot 
Demonstrates how the sea level atmospheric pressure dropped to a significantly low level and remained there during the landfall and slowly came up to normal as Lee moved further towards inland direction.
```{r echo=FALSE, message=FALSE, warning=FALSE, out.height = '50%', out.width= '90%'}
plot_buoy()
```

## Variogram
For analyzing variograms, we select three datasets from the package ‘hurricaneexposuredata’. We extracted the latitude and longitude of each county in ‘county_centers’, precip and wind data from “rain” and “storm_winds” , and joined three datasets into one by fips, which represent different counties, for subsequent analysis.

We could see the relationship between distance and variance using empirical variogram. Firstly using function variogram(), we got variogram figures about precip and wind separately, the x-axis is the distance between a pair of counties around hurricane path, and the y-axis is the semivariance of selected value between two counties, which formula is $\frac{(x-y)^2}{2}$, x and y is the data of precip or max sustained wind in two different counties. After we obtained the variogram, we tried to fit a variogram model to predict value. The figures are shown as follows.

```{r echo=FALSE, out.height = '70%', out.width= '55%'}
varg_Plot("precip",1)
varg_Plot("wind", 1)
```

However, the range of  variograms plotted by semivariance was limited, then we attempted another function vgram() to get an empirical variogram using the same dataset. The figures are shown as follows.

```{r echo=FALSE, out.height = '70%', out.width= '55%'}
varg_Plot("precip", 2)
varg_Plot("wind", 2)
```

In these two figures, we can see the relationship between distance and variance clearly, it shows a positive correlation at first, then the variance reaches a peak and it decreases as the  distance becomes larger, which means that the difference between two counties with the increase of distance, it first increases and then decreases, and this pattern is the same either for precip or wind though the slope of two figures has slightly different.
